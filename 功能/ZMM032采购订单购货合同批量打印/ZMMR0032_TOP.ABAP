*&---------------------------------------------------------------------*
*& 包含               ZMMR0032_TOP
*&---------------------------------------------------------------------*


TYPE-POOLS :SLIS.
" 使用ALV显示
DATA: I_FIELDCAT_ALV TYPE SLIS_T_FIELDCAT_ALV,
      WA_ALV_FIELD   TYPE SLIS_FIELDCAT_ALV.
DATA: IT_LAYOUT TYPE SLIS_LAYOUT_ALV,
      WA_LAYOUT TYPE LVC_S_LAYO.

DATA: OK_CODE TYPE SY-UCOMM,
      SAVE_OK TYPE SY-UCOMM.

TABLES: RESB,EKKO.

"打印
DATA: WA_CONTROL_PARAMETERS TYPE SSFCTRLOP,
      WA_OUT_OPTION         TYPE SSFCOMPOP,
      I_LASTOBJKY(30)       TYPE C,  "最后一行的凭证号
      I_FIRSTOBJKY(30)      TYPE C  "第一行的凭证号
      .

*定义输出内表

TYPES: BEGIN OF LS_EBELN,
         EBELN LIKE EKKO-EBELN, "凭证编号
         LIFNR LIKE EKKO-LIFNR, "供应商
         NAME1 LIKE LFA1-NAME1, "供应商名称
         EKGRP LIKE EKKO-EKGRP, "采购组
         BEDAT LIKE EKKO-BEDAT, "凭证日期
         SEL   TYPE C, "选择
       END OF LS_EBELN.

DATA:ZUCOMM TYPE SY-UCOMM.

"生产订单
DATA LT_EBELN TYPE STANDARD TABLE OF LS_EBELN .
*DATA lt_ebeln_tmp LIKE TABLE OF ls_ebeln WITH HEADER LINE .

DATA: GT_HEAD   TYPE TABLE OF ZMMS_ZMMR0017_HEAD,
      GS_HEAD   LIKE ZMMS_ZMMR0017_HEAD,
      GT_DETAIL TYPE TABLE OF ZMMS_ZMMR0017_DETAIL,
      GS_DETAIL LIKE ZMMS_ZMMR0017_DETAIL,
      GS_LINE   TYPE I.
DATA : GV_TDSFNAME TYPE TDSFNAME .