*&---------------------------------------------------------------------*
*& 包含               ZMMR0003_F02
*&---------------------------------------------------------------------*

*&---------------------------------------------------------------------*
*&      Form  frm_ALV_LIST_LAYOUT
*&---------------------------------------------------------------------*
*      ALV布局
*----------------------------------------------------------------------*
FORM FRM_ALV_LIST_LAYOUT .

    GS_LAYOUT_HEAD-CWIDTH_OPT = 'X'.
  *  ls_layout-edit       = 'X'.
    GS_LAYOUT_HEAD-ZEBRA      = 'X'.
  *  gs_layout_head-sel_mode   = 'D'.
  *  ls_layout-box_fname  = 'SEL'.
  
    GS_VARIAT-REPORT   = SY-REPID.
    GS_VARIAT-USERNAME = SY-UNAME.
  
    GS_LAYOUT_DETAIL = GS_LAYOUT_PO = GS_LAYOUT_HEAD.
    GS_LAYOUT_DETAIL-STYLEFNAME = 'CELL_STYLES'.
  ENDFORM. " frm_ALV_LIST_LAYOUT
  
  *&---------------------------------------------------------------------*
  *&      Form  frm_alv_fill_name
  *&---------------------------------------------------------------------*
  *       ALV字段设置
  *----------------------------------------------------------------------*
  FORM FRM_ALV_FILL_NAME USING IT_FIELDCAT TYPE LVC_T_FCAT
                               U_TYPE.
  
    CASE U_TYPE.
      WHEN 'HEAD'.
        PERFORM FRM_ALV_SET_FIELDCAT USING:
              SPACE 'SEL' SPACE SPACE SPACE SPACE TEXT-029 SPACE SPACE SPACE SPACE SPACE SPACE 'X' 'X' SPACE SPACE IT_FIELDCAT,
              SPACE 'guid ' SPACE SPACE SPACE SPACE 'APS唯一标识' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'WERKS' 'WERKS' 'MARC' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'LGORT' 'LGORT' 'MARD' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MATNR' 'MATNR' 'MARC' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MAKTX' 'MAKTX' 'MAKT' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ST_CODE' 'ST_CODE' 'ZMMAPS_PL' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
  *            space 'ST_CODE_TXT' space space space space TEXT-011 space space space space space space space space space space it_fieldcat,
              SPACE 'MFRNR' SPACE SPACE SPACE SPACE TEXT-012 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'PRODUCER_NAME' SPACE SPACE SPACE SPACE TEXT-013 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'GROES' SPACE 'MARA' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'EKGRP' SPACE 'MARC' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'APS_MENGE' SPACE 'ZMMAPS_PL' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MEINS' SPACE 'MARA' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MSEHT' SPACE 'T006A' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'VERSION' SPACE 'ZMMAPS_PL' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'REMAIN_DAYS' SPACE 'ZMMAPS_PL' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'REQDATE' SPACE 'ZMMAPS_PL' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              "ADD BY LANJINGCUN 20200426 最晚答复日期显示-start
              SPACE 'VERSIOM' SPACE SPACE SPACE SPACE TEXT-047 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZJSYUL' SPACE SPACE SPACE SPACE TEXT-045 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZZWDFR' SPACE SPACE SPACE SPACE TEXT-046 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
             "ADD BY LANJINGCUN 20200426 最晚答复日期显示-end
              SPACE 'RECEIVED_QUAN' SPACE 'ZMMWMS_POL' SPACE SPACE TEXT-014 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ASSIGNED_MENGE' SPACE SPACE SPACE SPACE TEXT-015 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
  *            space 'ZAPS_STSTXT' space space space space '处理状态' space space space space space space space space space space it_fieldcat,
              SPACE 'lifnr1 ' SPACE SPACE SPACE SPACE TEXT-016 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'name1_1' SPACE SPACE SPACE SPACE TEXT-017 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'vmenge1' SPACE SPACE SPACE SPACE TEXT-018 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'lifnr2 ' SPACE SPACE SPACE SPACE TEXT-019 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'name1_2' SPACE SPACE SPACE SPACE TEXT-020 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'vmenge2' SPACE SPACE SPACE SPACE TEXT-021 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'lifnr3 ' SPACE SPACE SPACE SPACE TEXT-022 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'name1_3' SPACE SPACE SPACE SPACE TEXT-023 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'vmenge3' SPACE SPACE SPACE SPACE TEXT-024 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'lifnr4 ' SPACE SPACE SPACE SPACE TEXT-025 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'name1_4' SPACE SPACE SPACE SPACE TEXT-026 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'vmenge4' SPACE SPACE SPACE SPACE TEXT-027 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MAKTXL ' SPACE SPACE SPACE SPACE TEXT-028 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZRSV01' SPACE 'ZMMAPS_PL' SPACE 'X' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZRSV02' SPACE 'ZMMAPS_PL' SPACE 'X' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZRSV03' SPACE 'ZMMAPS_PL' SPACE 'X' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZRSV04' SPACE 'ZMMAPS_PL' SPACE 'X' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ZRSV05' SPACE 'ZMMAPS_PL' SPACE 'X' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT.
  
      WHEN 'PO'.
        PERFORM FRM_ALV_SET_FIELDCAT USING:
              SPACE 'SEL' SPACE SPACE SPACE SPACE TEXT-029 SPACE SPACE SPACE SPACE SPACE SPACE 'X' GV_CHANGE SPACE SPACE IT_FIELDCAT,
              SPACE 'EBELN' SPACE 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'EBELP' SPACE 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'LIFNR' SPACE 'EKKO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE 'X' IT_FIELDCAT,
              SPACE 'NAME1' SPACE 'LFA1' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MFRNR' SPACE SPACE SPACE SPACE TEXT-012 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'PRODUCER_NAME' SPACE SPACE SPACE SPACE TEXT-013 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'po_date' 'BEDAT' 'EKKO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MATNR' 'MATNR' 'MARC' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MAKTX' 'MAKTX' 'MAKT' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MENGE' 'MENGE' 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MEINS' 'MEINS' 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'PRICE' SPACE SPACE SPACE SPACE TEXT-030 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'WAERS' SPACE 'EKKO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'BASE_MENGE' SPACE SPACE SPACE SPACE TEXT-031 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'lmein' 'MEINS' 'MARA' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ARRIVE_MENGE ' SPACE SPACE SPACE SPACE TEXT-032 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
  *            space 'SGFP_MENGE ' space space space space '手工发送WMS数量' space space space space space space space space space space it_fieldcat,
              SPACE 'CONFIRM_MENGE' SPACE SPACE SPACE SPACE TEXT-033 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'ASSIGNED_MENGE' 'MENGE' 'EKPO' SPACE SPACE TEXT-034 SPACE SPACE SPACE SPACE 'X' SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
              SPACE 'MATCH_MENGE ' SPACE SPACE SPACE SPACE TEXT-035 SPACE SPACE SPACE SPACE SPACE SPACE SPACE GV_CHANGE SPACE SPACE IT_FIELDCAT,
              SPACE 'LEFT_QUAN' SPACE SPACE SPACE SPACE TEXT-036 SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT.
      WHEN 'DETAIL'.
        PERFORM FRM_ALV_SET_FIELDCAT USING:
  *               space 'guid ' space space space space 'APS唯一标识' space space space space space space space space space space it_fieldcat,
                 'X' 'light ' SPACE SPACE SPACE SPACE '指示灯' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'VERSION ' SPACE SPACE SPACE SPACE 'APS版本' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'WERKS ' SPACE SPACE SPACE SPACE '工厂' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'LGORT ' SPACE SPACE SPACE SPACE '库存地点' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'MATNR' 'MATNR' 'MARC' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'MAKTX' 'MAKTX' 'MAKT' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'ST_CODE ' SPACE SPACE SPACE SPACE '指定标准' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'LIFNR ' SPACE 'EKKO' SPACE SPACE '供应商' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'VENDOR_NAME ' SPACE SPACE SPACE SPACE '供应商名称' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'EBELN' SPACE 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'EBELP' SPACE 'EKPO' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'MATCH_MENGE ' SPACE SPACE SPACE SPACE TEXT-035 SPACE SPACE SPACE SPACE SPACE SPACE SPACE GV_CHANGE SPACE SPACE IT_FIELDCAT,
                 SPACE 'MEINS' SPACE 'MARA' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'PRODUCER ' SPACE SPACE SPACE SPACE '制造商' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'PRODUCER_NAME' SPACE SPACE SPACE SPACE '制造商名称' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'REQDATE ' SPACE SPACE SPACE SPACE 'APS送货需求日期' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'PDLV_DATE ' SPACE SPACE SPACE SPACE '确认计划交货日期' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT,
                 SPACE 'pdlv_date_ext ' SPACE 'ZMMAPS_TEMP' SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE SPACE IT_FIELDCAT.
  
    ENDCASE.
  
  
  ENDFORM. " frm_alv_fill_name
  
  *&-------------------------------------------------------------------*
  *&      Form  frm_alv_set_fieldcat
  *&-------------------------------------------------------------------*
  *       Adds an entry to the field catalog.
  *--------------------------------------------------------------------*
  FORM FRM_ALV_SET_FIELDCAT USING UV_KEY TYPE ANY
                            UV_FIELDNAME     TYPE ANY
                            UV_REF_FIELD TYPE ANY
                            UV_REF_TABLE   TYPE ANY
                            UV_OUTPUTLEN     TYPE ANY
                            UV_NOOUT         TYPE ANY
                            UV_SCRTEXT_M     TYPE ANY
                            UV_SCRTEXT_L     TYPE ANY
                            UV_SCRTEXT_S     TYPE ANY
                            UV_REPTEXT_DDIC  TYPE ANY
                            UV_DDICTXT       TYPE ANY
                            UV_HOTSPOT       TYPE ANY
                            UV_SHOWASICON    TYPE ANY
                            UV_CHECKBOX      TYPE ANY
                            UV_EDIT          TYPE ANY
                            UV_DOSUM         TYPE ANY
                            UV_NO_ZERO       TYPE ANY
                            CT_FIELDCAT      TYPE LVC_T_FCAT.
  
    DATA: LS_FIELDCAT  TYPE LVC_S_FCAT,
          LV_FNAME(20).
    CLEAR LS_FIELDCAT.
  
  * General settings
    IF UV_FIELDNAME IS NOT INITIAL.
      LV_FNAME = UV_FIELDNAME.
      TRANSLATE LV_FNAME TO UPPER CASE.
      LS_FIELDCAT-FIELDNAME = LV_FNAME.
    ELSE.
      EXIT.
    ENDIF.
  
    LS_FIELDCAT-KEY = UV_KEY.
  
    LS_FIELDCAT-NO_OUT = UV_NOOUT.
    LS_FIELDCAT-HOTSPOT = UV_HOTSPOT.
    LS_FIELDCAT-CHECKBOX = UV_CHECKBOX.
    LS_FIELDCAT-ICON = UV_SHOWASICON.
    LS_FIELDCAT-DO_SUM = UV_DOSUM.
  
  
  *  ls_fieldcat-fix_column = uv_fix_column.
    LS_FIELDCAT-NO_ZERO = UV_NO_ZERO.
  
    IF UV_REF_TABLE IS INITIAL.
      LS_FIELDCAT-ROLLNAME =   UV_REF_FIELD.
    ELSE.
      LS_FIELDCAT-REF_TABLE = UV_REF_TABLE.
      IF UV_REF_FIELD EQ SPACE.
        LS_FIELDCAT-REF_FIELD =   LS_FIELDCAT-FIELDNAME.
      ELSE.
        LS_FIELDCAT-REF_FIELD =   UV_REF_FIELD.
      ENDIF.
      TRANSLATE LS_FIELDCAT-REF_TABLE TO UPPER CASE.
    ENDIF.
  
  * Set output length.
    IF NOT UV_OUTPUTLEN IS INITIAL.
      LS_FIELDCAT-OUTPUTLEN = UV_OUTPUTLEN.
    ENDIF.
  
  * Set text headers.
    IF NOT UV_SCRTEXT_M IS INITIAL.
      LS_FIELDCAT-SCRTEXT_M = UV_SCRTEXT_M.
    ENDIF.
    IF NOT UV_SCRTEXT_L IS INITIAL.
      LS_FIELDCAT-SCRTEXT_L = UV_SCRTEXT_L.
    ENDIF.
    IF NOT UV_SCRTEXT_S IS INITIAL.
      LS_FIELDCAT-SCRTEXT_S = UV_SCRTEXT_S.
    ENDIF.
  *  IF NOT uv_reptext_ddic IS INITIAL.
  *    ls_fieldcat-reptext_ddic = uv_reptext_ddic.
  *  ENDIF.
  *  IF NOT uv_ddictxt IS INITIAL.
  *    ls_fieldcat-ddictxt = uv_ddictxt.
  *  ENDIF.
  
  * Set as editable or not.
    IF UV_EDIT IS NOT INITIAL.
  *    ls_fieldcat-input     = 'X'.
      LS_FIELDCAT-EDIT     = 'X'.
    ENDIF.
  
    IF LV_FNAME = 'MATCH_MENGE'.
      LS_FIELDCAT-DECIMALS = 3.
    ENDIF.
  
    IF LV_FNAME = 'SEL'.
      LS_FIELDCAT-KEY = 'X'.
    ENDIF.
  
    APPEND LS_FIELDCAT TO CT_FIELDCAT.
  ENDFORM. "frm_alv_set_fieldcat